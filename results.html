<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resultados del Test - WebGazer Lab</title>
    <link rel="stylesheet" href="css/results.css">
    <!-- Heatmap.js desde CDN -->
    <script src="https://cdn.jsdelivr.net/npm/heatmap.js@2.0.5/build/heatmap.min.js"></script>
</head>
<body>
    <div class="container">
        <header class="results-header">
            <h1>ğŸ“Š Resultados del Test de Usabilidad</h1>
            <p class="subtitle">AnÃ¡lisis de Eye Tracking - TaskFlow</p>
        </header>

        <!-- Estado del test -->
        <section class="test-status">
            <div class="status-card">
                <span class="status-label">Estado:</span>
                <span id="testStatus" class="status-value">-</span>
            </div>
            <div class="status-card">
                <span class="status-label">DuraciÃ³n:</span>
                <span id="testDuration" class="status-value">-</span>
            </div>
            <div class="status-card">
                <span class="status-label">Puntos registrados:</span>
                <span id="totalPoints" class="status-value">-</span>
            </div>
        </section>

        <!-- VisualizaciÃ³n del heatmap -->
        <section class="heatmap-section">
            <div class="section-header">
                <h2>ğŸ”¥ Mapa de Calor</h2>
                <button id="btnToggleHeatmap" class="btn-toggle">Ocultar Heatmap</button>
            </div>
            
            <div class="heatmap-wrapper">
                <!-- Captura de pantalla de la pÃ¡gina de test -->
                <div id="testPageScreenshot" class="screenshot-container">
                    <iframe src="test-page.html" id="testPageFrame" scrolling="no"></iframe>
                </div>
                
                <!-- Overlay del heatmap -->
                <div id="heatmapContainer" class="heatmap-overlay"></div>
            </div>
        </section>

        <!-- EstadÃ­sticas -->
        <section class="stats-section">
            <h2>ğŸ“ˆ EstadÃ­sticas</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>Coordenada Promedio</h3>
                    <p id="avgCoords">-</p>
                </div>
                <div class="stat-card">
                    <h3>Muestras por segundo</h3>
                    <p id="samplesPerSec">-</p>
                </div>
                <div class="stat-card">
                    <h3>Tarea completada</h3>
                    <p id="taskStatus">-</p>
                </div>
            </div>
        </section>

        <!-- Zonas de mayor atenciÃ³n -->
        <section class="hotspots-section">
            <h2>ğŸ¯ Zonas de Mayor AtenciÃ³n</h2>
            <div id="hotspotsList" class="hotspots-list"></div>
        </section>

        <!-- AnÃ¡lisis segÃºn Nielsen -->
        <section class="analysis-section">
            <h2>ğŸ” AnÃ¡lisis de Usabilidad</h2>
            <div class="analysis-content">
                <h3>AnÃ¡lisis AutomÃ¡tico</h3>
                <div id="autoAnalysis" class="auto-analysis"></div>
                
                <h3>Tu AnÃ¡lisis (Completar segÃºn heurÃ­sticas de Nielsen)</h3>
                <textarea id="manualAnalysis" 
                          placeholder="Escribe aquÃ­ tu anÃ¡lisis considerando:
- Â¿QuÃ© zonas recibieron mayor atenciÃ³n?
- Â¿Existen elementos ignorados?
- Â¿La atenciÃ³n coincide con la jerarquÃ­a visual esperada?
- RelaciÃ³n con principios de Nielsen (visibilidad, reconocimiento, minimalismo)"
                          rows="10"></textarea>
                <button id="btnSaveAnalysis" class="btn-save">Guardar AnÃ¡lisis</button>
            </div>
        </section>

        <!-- Acciones -->
        <section class="actions-section">
            <button id="btnExportData" class="btn-action">ğŸ“¥ Exportar Datos (JSON)</button>
            <button id="btnNewTest" class="btn-action">ğŸ”„ Realizar Nuevo Test</button>
            <button id="btnBackToLab" class="btn-action">â† Volver al Laboratorio</button>
        </section>
    </div>

    <script type="module" src="js/results-controller.js"></script>
</body>
</html>